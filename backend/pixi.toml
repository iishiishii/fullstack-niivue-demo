[project]
authors = ["Taylor Hanayik <hanayik@gmail.com>"]
channels = ["conda-forge"]
description = "Demo fastAPI server that could work with niivue"
name = "backend"
platforms = ["linux-64", "osx-arm64", "linux-aarch64", "win-64"]
version = "0.1.0"

[tasks.dev]
cmd = """
  cd ../backend && \
  fastapi dev app/main.py
"""

[tasks.dev.env]
NIIVUE_BUILD_DIR = "../frontend/dist"
DATA_DIR = "../data"
SCENE_SCHEMA_ID = "niivue-fullstack-demo"

[tasks.migrate]
cmd = "alembic upgrade head"
description = "Run database migrations"

[tasks.migrate-auto]
cmd = "alembic revision --autogenerate -m 'Auto-generated migration'"
description = "Generate new migration from model changes"

[tasks.serve]
cmd = "fastapi run app/main.py"
description = "Run container development server"

[tasks.jupyterhub]
cmd = "jupyterhub --ip=0.0.0.0 --config=jupyterhub_config.py"
description = "Run JupyterHub with FastAPI service"

[dependencies]
fastapi = ">=0.115.5,<0.116"
configurable-http-proxy = ">=5.0.1,<6"
pyjwt = ">=2.10.1,<3"
passlib = ">=1.7.4,<2"
pydantic = ">=2.10.4"
httpx = ">=0.28.1"

[pypi-dependencies]
niimath = ">=1.0.20250529, <2"
sentry-sdk = ">=2.32.0, <3"
sqlmodel = ">=0.0.24, <0.0.25"
pydantic-settings = ">=2.10.1, <3"
psycopg = { version = ">=3.2.9, <4", extras = ["binary"] }
alembic = ">=1.16.2, <2"
alembic-postgresql-enum = ">=1.8.0, <2"
workos = ">=5.24.0"
